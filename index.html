<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Radical</title>
    <link rel="preconnect" href="https://fonts.googleapis.com" />
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;700&display=swap" rel="stylesheet" />
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/all.min.css" />
    <style>
        body {
            font-family: "Inter", Arial, sans-serif;
            margin: 0;
            padding: 0;
            overflow: hidden;
            background-color: #dfe1e5;
        }

        .browser-container {
            width: 100%;
            height: 100vh;
            display: flex;
            flex-direction: column;
        }

        .tab-bar-container {
            display: flex;
            align-items: center;
            background-color: #dfe1e5;
            padding: 6px 10px 0;
            flex-shrink: 0;
        }

        .tab-bar {
            display: flex;
            overflow-x: auto;
        }

        .tab-bar::-webkit-scrollbar {
            display: none;
        }

        .tab {
            display: flex;
            align-items: center;
            padding: 6px 12px;
            cursor: pointer;
            background-color: transparent;
            border: none;
            width: 225px;
            margin-right: 2px;
            border-radius: 12px 12px 0 0;
            color: #3c4043;
            flex-shrink: 0;
            position: relative;
            transition: background-color 0.2s ease;
        }

        .tab:hover {
            background-color: #f1f3f4;
        }

        .tab.active {
            background-color: #fff;
            color: #202124;
        }

        .tab.active:hover {
            background-color: #fff;
        }

        .tab-icon {
            width: 16px;
            height: 16px;
            margin-right: 8px;
        }
        
        .tab-title {
            white-space: nowrap;
            overflow: hidden;
            text-overflow: ellipsis;
            font-size: 13px;
            flex-grow: 1;
        }

        .tab-close {
            margin-left: auto;
            color: #5f6368;
            font-size: 18px;
            padding: 2px;
            border-radius: 50%;
            transition: color 0.1s ease, transform 0.1s ease, background-color 0.1s ease;
        }

        .tab-close:hover {
            color: #202124;
            transform: scale(1.1);
        }

        .url-bar-container {
            display: flex;
            align-items: center;
            background-color: #fff;
            border-bottom: 1px solid #dfe1e5;
            padding: 5px 10px;
        }

        .url-input {
            flex-grow: 1;
            padding: 8px 12px;
            box-sizing: border-box;
            border: none;
            border-radius: 20px;
            margin: 0 5px;
            font-size: 14px;
            background: #f1f3f4;
            color: #202124;
            outline: none;
            font-family: "Inter";
            transition: 0.15s;
        }

        .url-input:focus {
            background: #fff;
            box-shadow: 0 0 0 1px #1a73e8;
        }

        .icon-button {
            background: none;
            border: none;
            cursor: pointer;
            font-size: 18px;
            color: #5f6368;
            margin: 0 2px;
            width: 36px;
            height: 36px;
            border-radius: 50%;
            padding: 5px;
            transition: transform 0.1s ease, color 0.1s ease;
            flex-shrink: 0;
        }

        .icon-button:hover {
            transform: scale(1.15);
            color: #202124;
        }

        .new-tab-button {
            padding: 0;
            cursor: pointer;
            background: none;
            color: #5f6368;
            border: none;
            font-size: 22px;
            width: 36px;
            height: 36px;
            border-radius: 50%;
            transition: transform 0.1s ease, background-color 0.1s ease;
            flex-shrink: 0;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .new-tab-button:hover {
            transform: scale(1.15);
        }

        .browser-window {
            flex-grow: 1;
            position: relative;
            background-color: #fff;
        }

        .browser-window iframe {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            border: none;
            visibility: hidden;
            background-color: #fff;
        }
        
        .browser-window iframe.active {
            visibility: visible;
        }
    </style>
</head>
<body>
    <div class="browser-container">
        <div class="tab-bar-container">
            <div class="tab-bar" id="tab-bar"></div>
            <button class="new-tab-button" id="new-tab-btn">+</button>
        </div>
        <div class="url-bar-container">
            <button class="icon-button" id="back-btn"><i class="fa-solid fa-arrow-left"></i></button>
            <button class="icon-button" id="forward-btn"><i class="fa-solid fa-arrow-right"></i></button>
            <button class="icon-button" id="reload-btn"><i class="fa-solid fa-rotate-right"></i></button>
            <input type="text" class="url-input" id="url-input" placeholder="Search or type URL" />
        </div>
        <div class="browser-window" id="browser-window">
        </div>
    </div>

    <script src="/uv/uv.bundle.js"></script>
    <script src="/uv/uv.config.js"></script>
    
    <script>
        const tabBar = document.getElementById('tab-bar');
        const newTabBtn = document.getElementById('new-tab-btn');
        const backBtn = document.getElementById('back-btn');
        const forwardBtn = document.getElementById('forward-btn');
        const reloadBtn = document.getElementById('reload-btn');
        const urlInput = document.getElementById('url-input');
        const browserWindow = document.getElementById('browser-window');

        let tabs = [];
        let activeTabId = null;

        const getFavicon = (url) => `https://www.google.com/s2/favicons?sz=64&domain_url=${url}`;

        const renderTabs = () => {
            tabBar.innerHTML = '';
            tabs.forEach(tab => {
                const tabEl = document.createElement('div');
                tabEl.className = 'tab';
                tabEl.dataset.id = tab.id;
                if (tab.id === activeTabId) {
                    tabEl.classList.add('active');
                }

                tabEl.innerHTML = `
                    <img class="tab-icon" src="${tab.icon}" alt="">
                    <span class="tab-title">${tab.title}</span>
                    <span class="tab-close">Ã—</span>
                `;
                
                tabEl.addEventListener('click', () => switchTab(tab.id));
                tabEl.querySelector('.tab-close').addEventListener('click', (e) => {
                    e.stopPropagation();
                    closeTab(tab.id);
                });

                tabBar.appendChild(tabEl);
            });
        };
        
        const getActiveTab = () => tabs.find(t => t.id === activeTabId);

        const switchTab = (id) => {
            if (activeTabId === id) return;
            activeTabId = id;
            
            tabs.forEach(tab => {
                const iframe = document.getElementById(`iframe-${tab.id}`);
                if (iframe) {
                     iframe.classList.toggle('active', tab.id === activeTabId);
                }
            });

            const activeTab = getActiveTab();
            if (activeTab) {
                urlInput.value = activeTab.displayUrl || '';
            }
            
            renderTabs();
        };

        const createTab = (url = 'about:blank', makeActive = true) => {
            const newTab = {
                id: Date.now(),
                url: url === 'about:blank' ? '' : url,
                displayUrl: url === 'about:blank' ? '' : url,
                title: 'New Tab',
                icon: getFavicon(url),
            };

            const activeIndex = tabs.findIndex(tab => tab.id === activeTabId);
            if (activeIndex !== -1) {
                tabs.splice(activeIndex + 1, 0, newTab);
            } else {
                tabs.push(newTab);
            }

            const iframe = document.createElement('iframe');
            iframe.id = `iframe-${newTab.id}`;
            iframe.addEventListener('load', () => {
                 try {
                    const newTitle = iframe.contentDocument.title;
                    if (newTitle) {
                        newTab.title = newTitle;
                    }
                    const newUrl = iframe.contentWindow.location.href;
                    if (newUrl && newUrl !== 'about:blank') {
                        const decodedUrl = __uv$config.decodeUrl(newUrl.split(__uv$config.prefix).pop());
                        newTab.url = decodedUrl;
                        newTab.displayUrl = decodedUrl;
                        newTab.icon = getFavicon(decodedUrl);
                        if(newTab.id === activeTabId) urlInput.value = decodedUrl;
                    }
                } catch (e) {
                    console.error("Could not access iframe content:", e);
                } finally {
                    renderTabs();
                }
            });
            browserWindow.appendChild(iframe);
            
            if (makeActive) {
                switchTab(newTab.id);
            }

            if (url !== 'about:blank') {
                navigate(url, newTab.id);
            }

            renderTabs();
        };

        const closeTab = (id) => {
            const index = tabs.findIndex(tab => tab.id === id);
            if (index < 0) return;

            const iframe = document.getElementById(`iframe-${id}`);
            if (iframe) iframe.remove();
            
            const wasActive = activeTabId === id;
            tabs.splice(index, 1);

            if (tabs.length === 0) {
                createTab();
                return;
            }

            if (wasActive) {
                const newActiveIndex = Math.max(0, index - 1);
                switchTab(tabs[newActiveIndex].id);
            }
            
            renderTabs();
        };

        const navigate = (url, tabId = activeTabId) => {
            const tabToNavigate = tabs.find(t => t.id === tabId);
            if (!tabToNavigate) return;
            
            const iframe = document.getElementById(`iframe-${tabId}`);
            if (!iframe) return;

            let finalUrl = url;
            try {
                new URL(url);
            } catch {
                if (!url.includes('.') && !url.startsWith('localhost')) {
                   finalUrl = `https://www.google.com/search?q=${encodeURIComponent(url)}`;
                } else if (!url.startsWith('http')) {
                   finalUrl = `https://${url}`;
                }
            }

            tabToNavigate.url = finalUrl;
            tabToNavigate.displayUrl = url;
            tabToNavigate.icon = getFavicon(finalUrl);
            if (tabId === activeTabId) {
                urlInput.value = url;
            }

            iframe.src = __uv$config.prefix + __uv$config.encodeUrl(finalUrl);
            renderTabs();
        };

        newTabBtn.addEventListener('click', () => createTab());
        
        urlInput.addEventListener('keydown', (e) => {
            if (e.key === 'Enter') {
                e.preventDefault();
                navigate(urlInput.value);
            }
        });
        
        backBtn.addEventListener('click', () => {
            const activeIframe = document.querySelector('iframe.active');
            if(activeIframe) activeIframe.contentWindow.history.back();
        });
        
        forwardBtn.addEventListener('click', () => {
            const activeIframe = document.querySelector('iframe.active');
            if(activeIframe) activeIframe.contentWindow.history.forward();
        });
        
        reloadBtn.addEventListener('click', () => {
            const activeIframe = document.querySelector('iframe.active');
            if(activeIframe) activeIframe.contentWindow.location.reload();
        });

        createTab('https://www.google.com/webhp?igu=1');
    </script>
</body>
</html>


